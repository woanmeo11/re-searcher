FROM php:7.4.30-alpine

WORKDIR /src

RUN apk add git

RUN git clone https://github.com/laravel/laravel.git .
RUN git checkout e849812
RUN cp .env.example .env
RUN echo '{{ $name }}' >> resources/views/welcome.blade.php

RUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/bin --filename=composer
RUN chmod +x /usr/bin/composer 

RUN composer install 
RUN composer require facade/ignition==2.5.1

RUN mv /usr/local/etc/php/php.ini-production /usr/local/etc/php/php.ini 
RUN sed -i 's/;phar.readonly = On/phar.readonly = 0/g' /usr/local/etc/php/php.ini

EXPOSE 8000

ENTRYPOINT ["php", "artisan", "serve", "--host=0.0.0.0"]